# Ø£Ù…Ø«Ù„Ø© Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„ØªÙ†Ù‚Ù„

Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù ÙŠÙˆØ¶Ø­ Ø£Ù…Ø«Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„ØªÙ†Ù‚Ù„ ÙÙŠ Ø§Ù„Ø¨ÙˆØª.

## Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©      â”‚
â”‚                         â”‚
â”‚  ğŸ“‹ Ø§Ù„Ø®Ø·Ø· ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø±     â”‚
â”‚  ğŸ’³ Ø§Ø´ØªØ±Ø§Ùƒ              â”‚
â”‚  ğŸ“Š Ø§Ø´ØªØ±Ø§ÙƒØ§ØªÙŠ           â”‚
â”‚  ğŸ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©        â”‚
â”‚  â„¹ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ø§Ù„ÙƒÙˆØ¯**:
```python
keyboard = [
    [InlineKeyboardButton(text="ğŸ“‹ Ø§Ù„Ø®Ø·Ø· ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø±", callback_data="plans")],
    [InlineKeyboardButton(text="ğŸ’³ Ø§Ø´ØªØ±Ø§Ùƒ", callback_data="subscribe")],
    [InlineKeyboardButton(text="ğŸ“Š Ø§Ø´ØªØ±Ø§ÙƒØ§ØªÙŠ", callback_data="my_subscriptions")],
    [InlineKeyboardButton(text="ğŸ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©", callback_data="referral")],
    [InlineKeyboardButton(text="â„¹ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª", callback_data="info")],
]
```

## Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø®Ø·Ø·

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ“‹ Ø§Ù„Ø®Ø·Ø· ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø±     â”‚
â”‚                         â”‚
â”‚  Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ© - 10 USDT â”‚
â”‚  Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø´Ù‡Ø±ÙŠØ© - 30 USDT  â”‚
â”‚  Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø³Ù†ÙˆÙŠØ© - 300 USDT â”‚
â”‚                         â”‚
â”‚      â¬…ï¸ Ø±Ø¬ÙˆØ¹            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ø§Ù„ÙƒÙˆØ¯**:
```python
keyboard = []
for plan in plans:
    button_text = f"{plan.name_ar} - {plan.price} {plan.currency}"
    keyboard.append([
        InlineKeyboardButton(
            text=button_text,
            callback_data=f"plan_{plan.id}"
        )
    ])
keyboard.append([get_back_button("menu")])
```

## ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ“‹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø©       â”‚
â”‚                         â”‚
â”‚  Ø§Ù„Ø§Ø³Ù…: Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø´Ù‡Ø±ÙŠØ©   â”‚
â”‚  Ø§Ù„Ù…Ø¯Ø©: 30 ÙŠÙˆÙ…          â”‚
â”‚  Ø§Ù„Ø³Ø¹Ø±: 30 USDT         â”‚
â”‚                         â”‚
â”‚  ğŸ†“ ØªØ¬Ø±Ø¨Ø© Ù…Ø¬Ø§Ù†ÙŠØ©       â”‚
â”‚  ğŸ’³ Ø§Ù„Ø¯ÙØ¹ ÙˆØ§Ù„Ø§Ø´ØªØ±Ø§Ùƒ      â”‚
â”‚                         â”‚
â”‚      â¬…ï¸ Ø±Ø¬ÙˆØ¹            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ø§Ù„ÙƒÙˆØ¯**:
```python
keyboard = []
if can_use_trial:
    keyboard.append([
        InlineKeyboardButton(
            text="ğŸ†“ ØªØ¬Ø±Ø¨Ø© Ù…Ø¬Ø§Ù†ÙŠØ©",
            callback_data=f"trial_{plan_id}"
        )
    ])
keyboard.append([
    InlineKeyboardButton(
        text="ğŸ’³ Ø§Ù„Ø¯ÙØ¹ ÙˆØ§Ù„Ø§Ø´ØªØ±Ø§Ùƒ",
        callback_data=f"pay_{plan_id}"
    )
])
keyboard.append([get_back_button("plans")])
```

## ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø¯ÙØ¹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ’³ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø¯ÙØ¹      â”‚
â”‚                         â”‚
â”‚  Ø§Ù„Ø®Ø·Ø©: Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø´Ù‡Ø±ÙŠØ©   â”‚
â”‚  Ø§Ù„Ù…Ø¨Ù„Øº: 30 USDT        â”‚
â”‚                         â”‚
â”‚  Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: 0x1234...     â”‚
â”‚                         â”‚
â”‚  âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯ÙØ¹         â”‚
â”‚                         â”‚
â”‚      â¬…ï¸ Ø±Ø¬ÙˆØ¹            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ø§Ù„ÙƒÙˆØ¯**:
```python
keyboard = [
    [
        InlineKeyboardButton(
            text="âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯ÙØ¹",
            callback_data=f"confirm_payment_{payment_id}"
        )
    ],
    [get_back_button("menu")]
]
```

## Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©        â”‚
â”‚                         â”‚
â”‚  ABC12345               â”‚
â”‚                         â”‚
â”‚  ğŸ“‹ Ù†Ø³Ø® ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©     â”‚
â”‚  ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§ØªÙŠ           â”‚
â”‚  ğŸ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù†Ù‚Ø§Ø·      â”‚
â”‚                         â”‚
â”‚      â¬…ï¸ Ø±Ø¬ÙˆØ¹            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ø§Ù„ÙƒÙˆØ¯**:
```python
keyboard = [
    [
        InlineKeyboardButton(
            text="ğŸ“‹ Ù†Ø³Ø® ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©",
            callback_data=f"copy_referral_{referral_code}"
        )
    ],
    [
        InlineKeyboardButton(
            text="ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§ØªÙŠ",
            callback_data="referral_stats"
        )
    ],
    [
        InlineKeyboardButton(
            text="ğŸ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù†Ù‚Ø§Ø·",
            callback_data="redeem_points"
        )
    ],
    [get_back_button("menu")]
]
```

## ØªØ¯ÙÙ‚ Ø§Ù„ØªÙ†Ù‚Ù„

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 1: Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ø®Ø·Ø©

```
Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    â†“ (Ø§Ø¶ØºØ· "ğŸ“‹ Ø§Ù„Ø®Ø·Ø· ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø±")
Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø®Ø·Ø·
    â†“ (Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø®Ø·Ø©)
ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø©
    â†“ (Ø§Ø¶ØºØ· "ğŸ’³ Ø§Ù„Ø¯ÙØ¹ ÙˆØ§Ù„Ø§Ø´ØªØ±Ø§Ùƒ")
ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø¯ÙØ¹
    â†“ (Ø§Ø¶ØºØ· "âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯ÙØ¹")
Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­ Ø§Ù„Ø¯ÙØ¹
    â†“ (Ø§Ù„Ø¹ÙˆØ¯Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)
Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
```

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 2: Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©

```
Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    â†“ (Ø§Ø¶ØºØ· "ğŸ“‹ Ø§Ù„Ø®Ø·Ø· ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø±")
Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø®Ø·Ø·
    â†“ (Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø®Ø·Ø©)
ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø©
    â†“ (Ø§Ø¶ØºØ· "ğŸ†“ ØªØ¬Ø±Ø¨Ø© Ù…Ø¬Ø§Ù†ÙŠØ©")
Ø±Ø³Ø§Ù„Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¬Ø±Ø¨Ø©
    â†“ (Ø§Ù„Ø¹ÙˆØ¯Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)
Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
```

### Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 3: Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©

```
Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    â†“ (Ø§Ø¶ØºØ· "ğŸ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©")
Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¥Ø­Ø§Ù„Ø©
    â†“ (Ø§Ø¶ØºØ· "ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§ØªÙŠ")
Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¥Ø­Ø§Ù„Ø©
    â†“ (Ø²Ø± Ø±Ø¬ÙˆØ¹)
Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¥Ø­Ø§Ù„Ø©
    â†“ (Ø²Ø± Ø±Ø¬ÙˆØ¹)
Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
```

## Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹

**Ù…Ø¨Ø¯Ø£**: ÙƒÙ„ Ù‚Ø§Ø¦Ù…Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø²Ø± Ø±Ø¬ÙˆØ¹ (â¬…ï¸ Ø±Ø¬ÙˆØ¹)

**Ø§Ù„ÙƒÙˆØ¯**:
```python
def get_back_button(callback_data: str = "menu") -> InlineKeyboardButton:
    """Get back button"""
    return InlineKeyboardButton(text="â¬…ï¸ Ø±Ø¬ÙˆØ¹", callback_data=callback_data)
```

**Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…**:
```python
keyboard.append([get_back_button("menu")])  # Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
keyboard.append([get_back_button("plans")])  # Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø®Ø·Ø·
```

## Ø§Ø³ØªØ®Ø¯Ø§Ù… edit_message_text

**Ø§Ù„Ù…Ø¨Ø¯Ø£**: Ø§Ø³ØªØ®Ø¯Ø§Ù… `edit_message_text` Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©

**Ù…Ø«Ø§Ù„ ØµØ­ÙŠØ­**:
```python
@router.callback_query(F.data == "plans")
async def callback_plans(callback: CallbackQuery):
    await callback.message.edit_text(
        Texts.PLANS_TITLE,
        reply_markup=get_plans_keyboard(plans)
    )
    await callback.answer()
```

**Ù…Ø«Ø§Ù„ Ø®Ø§Ø·Ø¦** (âŒ):
```python
@router.callback_query(F.data == "plans")
async def callback_plans(callback: CallbackQuery):
    await callback.message.answer(  # âŒ Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
        Texts.PLANS_TITLE,
        reply_markup=get_plans_keyboard(plans)
    )
```

## Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„ØªÙŠ ØªØ±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©

ÙÙ‚Ø· ÙÙŠ Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:

1. **Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨** (`/start`):
```python
@router.message(CommandStart())
async def cmd_start(message: Message):
    await message.answer(  # âœ… Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
        Texts.WELCOME,
        reply_markup=get_main_menu_keyboard()
    )
```

2. **Ø¥Ø´Ø¹Ø§Ø± Ù†Ø¬Ø§Ø­ Ø§Ù„Ø¯ÙØ¹**:
```python
if success:
    await callback.message.answer(  # âœ… Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
        Texts.PAYMENT_CONFIRMED,
        reply_markup=get_main_menu_keyboard()
    )
```

3. **Ø¥Ø´Ø¹Ø§Ø± ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¬Ø±Ø¨Ø©**:
```python
await callback.message.answer(  # âœ… Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
    Texts.TRIAL_ACTIVATED.format(...),
    reply_markup=get_main_menu_keyboard()
)
```

4. **Ø¥Ø´Ø¹Ø§Ø± Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ** (Ù…Ù† background task):
```python
await bot.send_message(  # âœ… Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
    user_id,
    "âŒ ØªÙ… Ø¥Ø²Ø§Ù„ØªÙƒ Ù…Ù† Ø§Ù„Ù‚Ù†Ø§Ø© Ø¨Ø³Ø¨Ø¨ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ."
)
```

## Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙÙŠ Ø§Ù„ØªÙ†Ù‚Ù„

**Ø¹Ù†Ø¯ ÙØ´Ù„ edit_message_text** (Ù…Ø«Ù„Ø§Ù‹: Ù†ÙØ³ Ø§Ù„Ù…Ø­ØªÙˆÙ‰):
```python
try:
    await callback.message.edit_text(...)
except TelegramBadRequest:
    await callback.answer()  # ÙÙ‚Ø· Ø¥Ø®ÙØ§Ø¡ loading
```

**Ø¹Ù†Ø¯ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©**:
```python
try:
    # ... logic ...
except Exception as e:
    logger.error(f"Error: {e}", exc_info=True)
    await callback.answer(Texts.ERROR_OCCURRED, show_alert=True)
```

## Ù†ØµØ§Ø¦Ø­ Ù„Ù„ØªÙ†Ù‚Ù„

1. **Ø§Ø³ØªØ®Ø¯Ù… `callback.answer()`** Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù„Ø¥Ø®ÙØ§Ø¡ loading indicator
2. **Ø§Ø³ØªØ®Ø¯Ù… `show_alert=True`** Ù„Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ù‡Ù…Ø©
3. **Ø§Ø­ÙØ¸ Ø§Ù„Ø³ÙŠØ§Ù‚** ÙÙŠ callback_data (Ù…Ø«Ù„Ø§Ù‹: `plan_1`, `pay_1`)
4. **Ø§Ø³ØªØ®Ø¯Ù… Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ø¶Ø­Ø©** Ù…Ø¹ Ø±Ù…ÙˆØ² ØªØ¹Ø¨ÙŠØ±ÙŠØ©
5. **ØªØ£ÙƒØ¯ Ù…Ù† Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹** ÙÙŠ ÙƒÙ„ Ù‚Ø§Ø¦Ù…Ø©

