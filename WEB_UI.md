# Web UI Admin Panel

## نظرة عامة

تم إنشاء واجهة ويب إدارية (Web UI) للمسؤولين لإدارة البوت والاشتراكات.

## المميزات

### 1. لوحة التحكم (Dashboard)
- إحصائيات عامة (المستخدمين، الاشتراكات النشطة، المدفوعات المعلقة، الإيرادات)
- روابط سريعة للصفحات المختلفة

### 2. إدارة الخطط (Plans)
- عرض جميع الخطط
- إضافة خطط جديدة
- تعديل الخطط (قيد التطوير)
- حذف الخطط
- تفعيل/تعطيل الخطط

### 3. إدارة الاشتراكات (Subscriptions)
- عرض جميع الاشتراكات
- تفعيل الاشتراكات يدوياً
- عرض حالة الاشتراكات (نشط، تجربة، منتهي)

### 4. إدارة المستخدمين (Users)
- عرض جميع المستخدمين
- عرض معلومات المستخدمين (Telegram ID، Username، كود الإحالة)
- عرض حالة التجربة المجانية

### 5. الإعدادات (Settings)
- عرض الإعدادات الحالية
- ملاحظة: التعديل يتم عبر ملف `.env`

## كيفية الاستخدام

### 1. إعداد كلمة المرور

أضف كلمة المرور في ملف `.env`:

```env
ADMIN_PASSWORD=your_strong_password_here
```

### 2. تشغيل الخدمات

```bash
docker-compose up -d
```

### 3. الوصول للواجهة

افتح المتصفح واذهب إلى:

```
http://localhost:8080
```

**ملاحظة**: يمكنك تغيير المنفذ عبر متغير البيئة `WEB_PORT` في ملف `.env`

### 4. تسجيل الدخول

استخدم كلمة المرور التي عينتها في `ADMIN_PASSWORD`.

## الأمان

⚠️ **ملاحظات أمنية مهمة:**

1. **كلمة المرور**: استخدم كلمة مرور قوية في الإنتاج
2. **HTTPS**: في الإنتاج، استخدم HTTPS مع reverse proxy (nginx)
3. **الجلسات**: النظام الحالي يستخدم جلسات بسيطة في الذاكرة
   - في الإنتاج، استخدم Redis أو قاعدة بيانات للجلسات
4. **الوصول**: قم بتقييد الوصول إلى المنفذ 8000 في الإنتاج

## API Endpoints

### Authentication
- `GET /` - صفحة تسجيل الدخول
- `POST /login` - تسجيل الدخول
- `GET /logout` - تسجيل الخروج

### Dashboard
- `GET /dashboard` - لوحة التحكم

### Plans
- `GET /plans` - صفحة إدارة الخطط
- `GET /api/plans` - API: الحصول على جميع الخطط
- `POST /api/plans` - API: إنشاء خطة جديدة
- `PUT /api/plans/{plan_id}` - API: تحديث خطة
- `DELETE /api/plans/{plan_id}` - API: حذف خطة

### Subscriptions
- `GET /subscriptions` - صفحة إدارة الاشتراكات
- `POST /api/subscriptions/{subscription_id}/activate` - API: تفعيل اشتراك

### Users
- `GET /users` - صفحة إدارة المستخدمين

### Settings
- `GET /settings` - صفحة الإعدادات

## التطوير المستقبلي

### ميزات مقترحة:
1. ✅ إدارة الخطط
2. ✅ عرض الاشتراكات والمستخدمين
3. ⏳ تعديل الخطط (قيد التطوير)
4. ⏳ تأكيد المدفوعات يدوياً
5. ⏳ إحصائيات متقدمة
6. ⏳ تصدير البيانات
7. ⏳ إشعارات للمسؤولين
8. ⏳ نظام صلاحيات متقدم

## البنية

```
web/
├── Dockerfile          # Docker image للخدمة
├── requirements.txt    # Python dependencies
├── main.py            # FastAPI application
├── templates/         # HTML templates
│   ├── base.html
│   ├── login.html
│   ├── dashboard.html
│   ├── plans.html
│   ├── subscriptions.html
│   ├── users.html
│   └── settings.html
└── static/            # Static files (CSS, JS)
    ├── css/
    └── js/
```

## استكشاف الأخطاء

### المشكلة: لا يمكن الوصول للواجهة
**الحل**: 
- تحقق من أن الخدمة تعمل: `docker-compose ps`
- تحقق من السجلات: `docker-compose logs web`
- تحقق من أن المنفذ 8000 متاح

### المشكلة: خطأ في الاتصال بقاعدة البيانات
**الحل**:
- تحقق من أن خدمة `db` تعمل
- تحقق من `DATABASE_URL` في `.env`
- تحقق من أن قاعدة البيانات مهيأة: `docker-compose logs db`

### المشكلة: خطأ في تسجيل الدخول
**الحل**:
- تحقق من `ADMIN_PASSWORD` في `.env`
- تأكد من إعادة تشغيل الخدمة بعد تغيير `.env`

## ملاحظات

- الواجهة تستخدم Bootstrap 5 و Font Awesome
- التصميم متجاوب (Responsive)
- الواجهة باللغة العربية (RTL)

